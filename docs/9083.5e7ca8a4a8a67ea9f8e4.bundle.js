(self.webpackChunk_guidebooks_playground=self.webpackChunk_guidebooks_playground||[]).push([[9083,3228,561],{51956:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>p,doExec:()=>v});var o=t(11227),i=t.n(o),s=t(37767),r=t(18495);const c=i()("plugins/bash-like/util/json");var a=t(67712),d=t(186),l=function(e,n,t,o){return new(t||(t=Promise))((function(i,s){function r(e){try{a(o.next(e))}catch(e){s(e)}}function c(e){try{a(o.throw(e))}catch(e){s(e)}}function a(e){var n;e.done?i(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(r,c)}a((o=o.apply(e,n||[])).next())}))};const u=i()("plugins/bash-like/cmds/general");const v=(e,n,t)=>t.onInit||t.onExit||!r.Capabilities.isHeadless()||r.Capabilities.inProxy()?new Promise(((n,o)=>l(void 0,void 0,void 0,(function*(){try{const i={maxBuffer:1048576,cwd:t.cwd,env:Object.assign({},d.env,t.env||{})};d.env.SHELL&&(i.shell=d.env.SHELL);const r=(0,s.exec)(e,i);let a,v="",f="";t.onInit&&(u("setting up stdout via onInit",e.slice(0,10)),a=Promise.resolve(t.onInit({abort:()=>r.kill(),xon:()=>{},xoff:()=>{},write:()=>{}}))),t.pipeStdin&&d.stdin.pipe(r.stdin),r.stdout.on("data",(e=>l(void 0,void 0,void 0,(function*(){const n=e.toString();a?(yield a)(e):v+=n})))),r.stderr.on("data",(e=>l(void 0,void 0,void 0,(function*(){f+=e,t.stderr?t.stderr(e.toString()):a?(yield a)(e.toString()):u(e.toString())})))),r.on("error",o),r.on("close",(i=>l(void 0,void 0,void 0,(function*(){if(t.onExit)return u("onExit",i,e.slice(0,10)),void t.onExit(i);if(0===i)if(t&&t.json)try{n(JSON.parse(v))}catch(e){const n=new Error("unexpected non-JSON");n.value=v,o(n)}else if(t&&t.raw)n(v);else if(v||f){const e=(e=>{const n=e.substring(e.indexOf("{"));if(n.length>0)try{const e=JSON.parse(n);return c("successfully parsed out json",e),e}catch(e){}})(v);e&&"object"==typeof e?(e.type="shell",e.verb="get",n(e)):n(v)}else n(!0);else{u("non-zero exit code",i);const e=f.replace(/(^\/[^/]+\/[^:]+: )(line \d+: )?/,"");try{((e,n,t,o,i,s)=>{const r=0===o.length?t:o;if(i&&i.nested&&n<127){const e=new Error(r);throw e.code=n,e}{const e=new Error(r);throw e.html=s,i.stderr?e.code=s:/File exists/i.test(r)?e.code=409:127!==n&&/not found/i.test(r)?e.code=404:e.code=n,e}})(0,i,v,e,t)}catch(e){o(e)}}}))))}catch(e){o(e)}})))):function(e,n){return new Promise(((t,o)=>l(this,void 0,void 0,(function*(){try{const i={cwd:n.cwd,env:Object.assign({},d.env,n.env||{})};d.env.SHELL&&e.find((e=>/&&|>|\||`|\$/.test(e)))&&(i.shell=d.env.SHELL),n.onInit||n.onExit||!r.Capabilities.isHeadless()||r.Capabilities.inProxy()||(i.stdio="inherit");const c=(0,s.spawn)(e[0],e.slice(1),i);c.on("error",o),c.on("close",(e=>l(this,void 0,void 0,(function*(){0===e?t(!0):o(new Error(`non-zero exit code: ${e}`))}))))}catch(e){o(e)}}))))}(n,t),f=e=>{if(e.execOptions.type===r.ExecType.TopLevel)throw new Error("this command is intended for internal consumption only");return(0,a.XN)(e)},p=e=>{e.listen("/!",a.XN,{docs:"Execute a UNIX shell command",requiresLocal:!0}),e.listen("/sendtopty",f,{docs:"Execute a UNIX shell command with a PTY",hidden:!0}),e.listen("/pwd",(()=>d.env.PWD||d.env.HOME||"/"))}},67712:(e,n,t)=>{"use strict";t.d(n,{XN:()=>a,Io:()=>d,MA:()=>l});var o=t(11227),i=t.n(o),s=t(16426),r=function(e,n,t,o){return new(t||(t=Promise))((function(i,s){function r(e){try{a(o.next(e))}catch(e){s(e)}}function c(e){try{a(o.throw(e))}catch(e){s(e)}}function a(e){var n;e.done?i(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(r,c)}a((o=o.apply(e,n||[])).next())}))};const c=i()("plugins/bash-like/cmds/catchall"),a=({tab:e,REPL:n,command:o,argv:i,argvNoOptions:c,execOptions:a,parsedOptions:d,createOutputStream:l})=>r(void 0,void 0,void 0,(function*(){const r=e=>{if(e.message&&"string"==typeof e.message){const n=new Error(e.message.replace(/[a-zA-Z0-9/]+:\s*/,"").trim());throw n.code=e.code,n}throw e},{ExecType:u}=yield Promise.resolve().then(t.bind(t,18495)),v=(a.raw||a.type===u.Nested)&&void 0===a.quiet&&void 0===a.echo&&void 0===a.replSilence,f=v||a.isProxied?a:Object.assign({cwd:yield(0,s.Z)(a,n)},{stdout:yield l()},a),p=o.replace(/^(!|sendtopty)\s+/,""),{Capabilities:h}=yield Promise.resolve().then(t.bind(t,18495));if(h.isHeadless()||!h.inBrowser()&&v){const{doExec:e}=yield t.e(3228).then(t.bind(t,51956)),n="sendtopty"===i[0]?i.slice(1):i,o=yield e(p,n,f).catch(r);if(v&&("number"==typeof o||"boolean"==typeof o))return o;if(v&&"string"==typeof o)try{return isNaN(parseInt(o))?JSON.parse(o):o}catch(e){}return o}{const{doExec:o}=yield Promise.all([t.e(8575),t.e(9267),t.e(9224),t.e(2320),t.e(8885),t.e(116)]).then(t.bind(t,48885)),i=()=>o(e,n,p,c,d,f);if(v){f.quiet=!0,f.echo=!1,f.replSilence=!0;let e="";return f.onInit=()=>n=>{"string"==typeof n&&(e+=n)},i().then((()=>e)).catch(r)}return i().catch(r)}}));function d(e){return r(this,void 0,void 0,(function*(){const{Capabilities:n}=yield Promise.resolve().then(t.bind(t,18495));return new Promise(((t,o)=>r(this,void 0,void 0,(function*(){let i="";const s=Object.assign({},e.execOptions,{rethrowErrors:!0,quiet:!0,replSilence:!0,echo:!1,onInit:()=>e=>{"string"==typeof e&&(i+=e)}}),r=Object.assign({},e,{execOptions:s});yield a(r).catch((e=>{const t=i||e.message;i&&n.isHeadless()?c(t):c(e),e.message=t,o(e)})),t(i)}))))}))}const l=e=>r(void 0,void 0,void 0,(function*(){const{Capabilities:n}=yield Promise.resolve().then(t.bind(t,18495));if(!n.inBrowser()||n.hasProxy())return e.catchall((()=>!0),a,0);c("skipping catchall registration: in browser and no remote proxy to support it")}))},16426:(e,n,t)=>{"use strict";t.d(n,{Z:()=>s});var o=t(18495),i=function(e,n,t,o){return new(t||(t=Promise))((function(i,s){function r(e){try{a(o.next(e))}catch(e){s(e)}}function c(e){try{a(o.throw(e))}catch(e){s(e)}}function a(e){var n;e.done?i(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(r,c)}a((o=o.apply(e,n||[])).next())}))};function s(e,n){return i(this,void 0,void 0,(function*(){return e.cwd||((yield n.rexec(`vfs ls -d ${(0,o.encodeComponent)(o.Util.cwd())}`)).content[0].dirent.mount.isLocal?o.Util.cwd():o.Util.expandHomeDir("~"))}))}},30890:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>l});var o=t(51956),i=t(29224),s=t(18495),r=t(67712),c=function(e,n,t,o){return new(t||(t=Promise))((function(i,s){function r(e){try{a(o.next(e))}catch(e){s(e)}}function c(e){try{a(o.throw(e))}catch(e){s(e)}}function a(e){var n;e.done?i(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(r,c)}a((o=o.apply(e,n||[])).next())}))};const a=e=>c(void 0,void 0,void 0,(function*(){const{command:n,tab:t,parsedOptions:o}=e,i=s.SymbolTable.read(t),c=o._[1].split("=")[0],a=/;\s*$/.test(n)?"":";",d=Object.assign({},e,{command:`${n}${a} echo -n $${c}`}),l=yield(0,r.Io)(d);return i[c]=l,s.SymbolTable.write(t,i),s.Events.eventBus.emitEnvUpdate(c,l),!0})),d={command:"export",docs:"Export a variable or function to the environment of all the child processes running in the current shell",required:[{name:"key=value",docs:"an assignment of key to value"}]},l=e=>{return Promise.all([(0,o.default)(e),(0,i.default)(e),(n=e,void n.listen("/export",a,{usage:d}))]);var n}},37767:()=>{},67953:()=>{},10561:()=>{}}]);